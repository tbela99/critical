{"version":3,"file":"browser.js","sources":["../src/file/download.ts","../src/file/path.ts","../src/critical/fontscript.ts","../src/critical/extract.ts","../src/browser.ts"],"sourcesContent":["/**\n *\n * @param {string[]} content\n * @param {string} filename\n * @param {string} mimetype\n * @return {Promise<string[]>}\n */\nexport async function download(content: Array<string>, filename: string, mimetype: string = 'application/octet-stream; charset=utf-8'): Promise<Array<string>> {\n\n    //\n    const url: string = URL.createObjectURL(new Blob(content, {type: mimetype}));\n    //\n    const a: HTMLAnchorElement = document.createElement('a');\n    document.body.append(a);\n    a.style.display = 'none';\n    a.download = filename;\n    a.href = url;\n\n    //\n    a.dispatchEvent(new MouseEvent('click'));\n    URL.revokeObjectURL(url);\n\n    return content;\n}","\nexport function resolve(path: string, from: string): string {\n\n    if (path.match(/^['\"]?data:/)) {\n\n        return path;\n    }\n\n    // @ts-ignore\n    const baseURL: URL = new URL(from, window.location);\n    const pathURL: URL = new URL(path, baseURL);\n\n    if (baseURL.protocol != pathURL.protocol ||\n        baseURL.host != pathURL.host ||\n        pathURL.host != window.location.host ||\n        baseURL.port != pathURL.port ||\n        pathURL.port != window.location.port ||\n        baseURL.port != pathURL.port ||\n        pathURL.protocol != window.location.protocol\n    ) {\n\n        return pathURL.toString();\n    }\n\n    return pathURL.pathname + pathURL.search + pathURL.hash;\n}","import type {FontObject} from \"../@types\";\n\nexport function fontscript(fonts: FontObject[]): string {\n\n    return '/* font preloader script: ' + fonts.length + ' */\\n\"fonts\" in document && ' + JSON.stringify([...fonts], null, 1) + '.forEach(font => new FontFace(font.fontFamily, font.src, font.properties).load().then(font => document.fonts.add(font)))'\n}","import {resolve} from \"../file\";\nimport {fontscript} from \"./fontscript\";\nimport type {\n    CriticalExtractOptions,\n    CriticalResult,\n    FileMapObject,\n    FontObject,\n    MatchCSSStyleSheet,\n    RuleList\n} from \"../@types\";\n\nexport async function extract(options: CriticalExtractOptions = {}) {\n\n    const document: Document = window.document;\n    const location: Location = window.location;\n    const styles: Set<string> = new Set;\n    const excluded: string[] = ['all', 'print', ''];\n    const allStylesheets: MatchCSSStyleSheet[] = [];\n\n    // Get a list of all the elements in the view.\n    const height: number = window.innerHeight;\n    const walker: NodeIterator = document.createNodeIterator(document, NodeFilter.SHOW_ELEMENT, {acceptNode: () => NodeFilter.SHOW_ELEMENT});\n\n    const fonts: Set<CSSFontFaceRule> = new Set;\n    const fontFamilies: Set<string> = new Set;\n    const files: Map<CSSStyleSheet, FileMapObject> = new Map;\n    const weakMap: WeakMap<RuleList | CSSStyleSheet, number> = new WeakMap;\n    const nodeMap: Set<Node> = new Set;\n    let nodeCount: number = 0;\n    let k: number;\n    let rule: CSSMediaRule | CSSStyleRule;\n    let rules;\n\n    performance.mark('filterStylesheets');\n\n    for (k = 0; k < document.styleSheets.length; k++) {\n\n        // @ts-ignore\n        rule = <CSSMediaRule>document.styleSheets[k];\n\n        if (rule.media.mediaText === 'print' || (rule.media.mediaText !== '' && !window.matchMedia(rule.media.mediaText).matches)) {\n\n            continue;\n        }\n\n        try {\n\n            // @ts-ignore\n            rules = (<CSSStyleSheet>rule).cssRules ?? (<CSSStyleSheet>rule).rules;\n\n            for (let l = 0; l < rules.length; l++) {\n\n                allStylesheets.push({rule: rules[l], match: false})\n            }\n\n        } catch (e) {\n\n            // @ts-ignore\n            console.error(JSON.stringify({'message': e.message, stylesheet: rule.href}, null, 1));\n        }\n    }\n\n    performance.measure('filter stylesheets', 'filterStylesheets');\n\n    if (allStylesheets.length === 0) {\n\n        return {styles: [], fonts: [], stats: {}};\n    }\n\n    let node;\n    let rect;\n    let allStylesLength = allStylesheets.length;\n\n    performance.mark('nodeWalking');\n\n    while ((node = <HTMLElement>walker.nextNode())) {\n\n        if (options && options.signal && options.signal.aborted) {\n\n            return Promise.reject('Aborted');\n        }\n\n        if (['SCRIPT', 'LINK', 'HEAD', 'META', 'TITLE', 'NOSCRIPT'].includes(node.tagName)) {\n\n            continue;\n        }\n\n        nodeCount++;\n        rect = node.getBoundingClientRect();\n\n        if (rect.top < height) {\n\n            nodeMap.add(node);\n        }\n    }\n\n    for (k = 0; k < allStylesLength; k++) {\n\n        if (allStylesheets[k].match || weakMap.has(allStylesheets[k].rule)) {\n\n            continue;\n        }\n\n        weakMap.set(allStylesheets[k].rule, 1);\n\n        if (allStylesheets[k].rule instanceof CSSStyleRule) {\n\n            // @ts-ignore\n            let selector = allStylesheets[k].rule.selectorText;\n            let match;\n\n            // detect pseudo selectors\n            if (selector.match(/(^|,|\\s)::?((before)|(after))/)) {\n\n                match = true\n            } else {\n\n                if (selector.match(/::?((before)|(after))/)) {\n\n                    selector = selector.replace(/::?((before)|(after))\\s*((,)|$)/g, '$5');\n                }\n\n                try {\n\n                    match = nodeMap.has(document.querySelector(selector));\n                } catch (e) {\n\n                    // @ts-ignore\n                    match = nodeMap.has(document.querySelector(allStylesheets[k].rule.selectorText));\n                }\n            }\n\n            if (match) {\n\n                allStylesheets[k].match = true;\n\n                // @ts-ignore\n                if (allStylesheets[k].rule.style.getPropertyValue('font-family')) {\n\n                    // @ts-ignore\n                    allStylesheets[k].rule.style.getPropertyValue('font-family').split(/\\s*,\\s*/).forEach(fontFamily => fontFamily !== 'inherit' && fontFamilies.add(fontFamily.replace(/(['\"])([^\\1\\s]+)\\1/, '$2')));\n                }\n            }\n\n        } else if (allStylesheets[k].rule instanceof CSSMediaRule || allStylesheets[k].rule instanceof CSSImportRule || allStylesheets[k].rule instanceof CSSConditionRule) {\n\n            // @ts-ignore\n            if ((allStylesheets[k].rule instanceof CSSMediaRule || allStylesheets[k].rule instanceof CSSImportRule) && (allStylesheets[k].rule.media.mediaText === 'print' || (allStylesheets[k].rule.media.mediaText !== '' && !window.matchMedia(allStylesheets[k].rule.media.mediaText).matches))) {\n                continue;\n            }\n\n            try {\n\n                const rule = allStylesheets[k].rule;\n                const rules = [];\n                // @ts-ignore\n                const sheet = rule instanceof CSSImportRule ? rule.styleSheet.cssRules || rule.styleSheet.rules : rule.cssRules || rule.rules;\n\n                for (let l = 0; l < sheet.length; l++) {\n\n                    if (!weakMap.has(sheet[l])) {\n\n                        rules.push({rule: sheet[l], match: false})\n                    }\n                }\n\n                if (rules.length > 0) {\n\n                    // @ts-ignore\n                    allStylesheets.splice.apply(allStylesheets, [k + 1, 0].concat(rules))\n                    allStylesLength = allStylesheets.length\n                }\n            } catch (e) {\n\n                // @ts-ignore\n                console.error(JSON.stringify({'message': e.message, stylesheet: rule.href}, null, 1));\n            }\n        } else if (allStylesheets[k].rule instanceof CSSFontFaceRule) {\n\n            // @ts-ignore\n            if (allStylesheets[k].rule.style.getPropertyValue('font-family') && allStylesheets[k].rule.style.getPropertyValue('src')) {\n\n                // @ts-ignore\n                fonts.add(allStylesheets[k].rule);\n            }\n        }\n    }\n\n    performance.measure('node walking', 'nodeWalking');\n\n    let css;\n    let file = '';\n    let inlineCount = -1;\n\n    performance.mark('rulesExtraction');\n\n    loop1:\n        for (let k = 0; k < allStylesLength; k++) {\n\n            if (!allStylesheets[k].match) {\n\n                continue;\n            }\n\n            // @ts-ignore\n            rule = allStylesheets[k].rule;\n            let fileUpdate: boolean = false;\n\n            // @ts-ignore\n            if (!files.has(rule.parentStyleSheet)) {\n\n                //\n                // @ts-ignore\n                files.set(rule.parentStyleSheet, {\n\n                    // @ts-ignore\n                    base: (rule.parentStyleSheet.href && rule.parentStyleSheet.href.replace(/[?#].*/, '') || location.pathname).replace(/([^/]+)$/, ''),\n                    // @ts-ignore\n                    file: rule.parentStyleSheet.href || `inline style #${++inlineCount}`\n                });\n\n                fileUpdate = true;\n            } else { // @ts-ignore\n                if (file != null && file !== files.get(rule.parentStyleSheet).file) {\n\n                    fileUpdate = true;\n                }\n            }\n\n            if (fileUpdate) {\n\n                try {\n\n                    // @ts-ignore\n                    console.error('analysing ' + files.get(rule.parentStyleSheet).file);\n                    // @ts-ignore\n                    styles.add('/* file: ' + files.get(rule.parentStyleSheet).file + ' */');\n                } catch (e) {\n\n                    // @ts-ignore\n                    console.error(JSON.stringify(e.message, null, 1));\n                    console.error(JSON.stringify(rule?.parentStyleSheet?.href, null, 1));\n                }\n            }\n\n            file = (<FileMapObject>files.get(<CSSStyleSheet>rule.parentStyleSheet)).file;\n            css = rule.cssText;\n\n            // @ts-ignore\n            console.error({sel: rule.selectorText, css});\n\n            if (file !== 'inline') {\n\n                // resolve url()\n                css = css.replace(/url\\(([^)%\\s]*?)\\)/g, function (all, one) {\n\n                    one = one.trim();\n\n                    if (one.match(/^['\"]?data:/)) {\n\n                        return all;\n                    }\n\n                    one = one.replace(/^(['\"])([^\\1\\s]+)\\1/, '$2');\n\n                    // @ts-ignore\n                    return 'url(' + resolve(one, files.get(rule.parentStyleSheet).base) + ')';\n                })\n            }\n\n            while (rule.parentRule) {\n\n                /**\n                 *\n                 * @type {CSSMediaRule}\n                 */\n                // @ts-ignore\n                rule = rule.parentRule;\n\n                // @ts-ignore\n                if (rule.conditionText == 'print') {\n\n                    continue loop1;\n                }\n\n                // @ts-ignore\n                if (!excluded.includes(rule.conditionText)) {\n\n                    // @ts-ignore\n                    css = '@' + rule.constructor.name.replace(/^CSS(.*?)Rule/, '$1').toLowerCase() + ' ' + rule.conditionText + ' {' + css + '}';\n                }\n\n                if (!rule.parentRule) {\n\n                    break;\n                }\n            }\n\n            if (rule.parentStyleSheet) {\n\n                let media: string = rule.parentStyleSheet.media.mediaText;\n\n                if (media === 'print') {\n\n                    continue;\n                }\n\n                if (media !== '') {\n\n                    css = '@media ' + media + ' {' + css + '}';\n                }\n            }\n\n            if (styles.has(css)) {\n\n                styles.delete(css);\n            }\n\n            styles.add(css);\n        }\n\n    performance.measure('rules extraction', 'rulesExtraction');\n\n    const usedFonts = new Map;\n\n    if (options.fonts) {\n\n        let j;\n        let name;\n        let value;\n        let font: CSSFontFaceRule;\n        let fontObject;\n        let src;\n\n        performance.mark('fontsExtraction');\n\n        for (font of fonts) {\n\n            if (font.style.getPropertyValue('font-family').split(/\\s*,\\s*/).some(token => {\n\n                return fontFamilies.has(token.replace(/(['\"])([^\\1\\s]+)\\1/, '$2'));\n            })) {\n\n                src = font.style.getPropertyValue('src');\n\n                if (!src) {\n\n                    continue;\n                }\n\n                fontObject = {\n                    'fontFamily': font.style.getPropertyValue('font-family').replace(/(['\"])([^\\1\\s]+)\\1/, '$2'),\n                    src: src.replace(/(^|[,\\s*])local\\([^)]+\\)\\s*,?\\s*?/g, '').replace(/url\\(([^)%\\s]+)\\)([^,]*)(,?)\\s*/g, (all, one, two, three) => {\n\n                        one = one.replace(/(['\"])([^\\1\\s]+)\\1/, '$2');\n\n                        // @ts-ignore\n                        if (!files.has(font.parentStyleSheet)) {\n\n                            // @ts-ignore\n                            if (!font.parentStyleSheet.href) {\n\n                                return all;\n                            }\n\n                            // @ts-ignore\n                            files.set(font.parentStyleSheet, {\n\n                                // @ts-ignore\n                                base: font.parentStyleSheet.href.replace(/([^/]+)$/, ''),\n                                // @ts-ignore\n                                file: font.parentStyleSheet.href\n                            })\n                        }\n\n                        // @ts-ignore\n                        return 'url(' + resolve(one, files.get(font.parentStyleSheet).base) + ')' + three;\n                    }).trim(),\n                    properties: {}\n                }\n\n                j = font.style.length;\n\n                while (j--) {\n\n                    name = font.style.item(j);\n                    value = font.style.getPropertyValue(name);\n\n                    name !== 'font-family' &&\n                    name !== 'src' &&\n                    value !== '' &&\n                    value !== undefined &&\n                    // @ts-ignore\n                    (fontObject.properties[name.replace(/([A-Z])/g, (all, name) => '-' + name.toLowerCase())] = value)\n                }\n\n                usedFonts.set(JSON.stringify(fontObject), fontObject)\n            }\n        }\n\n        performance.measure('fonts extraction', 'fontsExtraction');\n    }\n\n    const stats = performance.getEntriesByType(\"measure\").filter(entry => ['filter stylesheets', 'node walking', 'rules extraction', 'fonts extraction'].includes(entry.name)).map(entry => {\n\n        return {\n\n            name: entry.name,\n            duration: (entry.duration / 1000).toFixed(3) + 's'\n        }\n    });\n\n\n    const result: CriticalResult = {\n        styles: [...styles],\n        fonts: [...usedFonts.values()],\n        nodeCount,\n        stats: {nodeCount, stats}\n    };\n\n    if (options.html) {\n\n        if (!document.querySelector('base')) {\n\n            const base: HTMLBaseElement = document.createElement('base');\n\n            base.href = options.base ?? (location.protocol + '//' + location.host + location.pathname);\n            document.head.insertBefore(base, document.querySelector('meta[charset]')?.nextElementSibling || document.head.firstChild)\n        }\n\n        if (!document.querySelector('meta[charset]')) {\n\n            const meta = document.createElement('meta');\n            meta.setAttribute('charset', 'utf-8');\n            document.head.insertBefore(meta, document.head.firstChild)\n        }\n\n        // @ts-ignore\n        Array.from(document.querySelectorAll('style,link[rel=stylesheet]')).forEach((node: HTMLLinkElement | HTMLStyleElement) => {\n\n            document.body.append(node);\n\n            if (node.tagName === 'LINK') {\n\n                if (node.media === 'print') {\n\n                    return\n                }\n\n                if (node.hasAttribute('media')) {\n\n                    node.setAttribute('data-media', node.media);\n                }\n\n                node.media = 'print';\n                node.dataset.async = '';\n            }\n        });\n\n        const script: HTMLScriptElement = document.createElement('script');\n\n        script.textContent = `\n        window.addEventListener('DOMContentLoaded', () => Array.from(document.querySelectorAll('link[data-async]')).forEach(node => {\n\n                if(!node.hasAttribute('data-media')) {\n                    node.removeAttribute('media');\n                }\n                else {\n                    node.media=node.dataset.media;\n                    node.removeAttribute('data-media')\n                }\n                \n                node.removeAttribute('data-async');\n        }))`;\n\n        document.head.append(script);\n\n        // add data-attribute\n        const style: HTMLStyleElement = document.createElement('style');\n        // @ts-ignore\n        style.dataset.critical = true;\n        style.textContent = [...usedFonts.values()].map((entry) => {\n\n                return '@font-face {' + '\\n ' + Object.entries(entry).map(entry => {\n\n                    // @ts-ignore\n                    return typeof entry[1] == 'string' ? `${entry[0] + ': ' + entry[1]}` : Object.entries(entry[1]).map(entry => `${entry[0] + ': ' + entry[1]}`).join(';\\n ') + '\\n}'\n                }).join(';\\n')\n            }).join('\\n') +\n            '\\n' + (<string[]>result.styles).join('\\n');\n\n        if (style.textContent.trim() !== '') {\n\n            document.head.insertBefore(style, <HTMLBaseElement | null>document.querySelector('base')?.nextElementSibling);\n        }\n\n        if ((<FontObject[]>result.fonts).length > 0) {\n\n            const script: HTMLScriptElement = document.createElement('script');\n            script.textContent = fontscript(<FontObject[]>result.fonts);\n            document.head.append(script);\n        }\n\n        const doctype: DocumentType = document.doctype as DocumentType;\n\n        result.html = `<!Doctype ${doctype.name}`\n            + (doctype.publicId ? ` PUBLIC \"${doctype.publicId}\"` : '')\n            + (doctype.systemId\n                ? (doctype.publicId ? `` : ` SYSTEM`) + ` \"${doctype.systemId}\"`\n                : ``)\n            + `>` + '\\n' + document.documentElement.outerHTML\n    }\n\n    return result;\n}\n","import {extract} from \"./critical/extract\";\nimport {download} from \"./file/download\";\nimport {fontscript} from \"./critical/fontscript\";\nimport {CriticalExtractOptions, CriticalResult} from \"./@types\";\n\nasync function extractAndDownload(filename: string = 'critical.css', options: CriticalExtractOptions = {}): Promise<CriticalResult> {\n\n    return extract(options).\n        then(async (content : CriticalResult): Promise<CriticalResult> => download(<string[]>content.styles, filename, 'text/css; charset=utf-8').\n            then(async () => {\n\n                if ((<string[]>content.fonts).length > 0) {\n\n                    // @ts-ignore\n                    return download([fontscript(<string[]>content.fonts)], filename.replace(/\\.css$/, '.js'), 'text/javascript; charset=utf-8');\n                }\n        }).\n        then(() => content)\n    );\n}\n\nexport {extract, fontscript, extractAndDownload as download}"],"names":[],"mappings":"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"}